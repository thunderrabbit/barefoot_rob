<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learning a lot about AWS &middot; Barefoot Rob</title>

    <meta name="description" content="">

    <meta name="generator" content="Hugo 0.58.3" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="thunderrabbit" />
    <meta name="twitter:title" content="Learning a lot about AWS &middot; Barefoot Rob">
    <meta name="twitter:description" content="">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Learning a lot about AWS &middot; Barefoot Rob">
    <meta property="og:description" content="">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">

    <link rel="stylesheet" href='https://new.robnugen.com/css/all.min.css'>
    <link rel="stylesheet" href='https://new.robnugen.com/css/barefoot_rob.css'>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="Barefoot Rob" href='https://new.robnugen.com/index.xml' />
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="https://new.robnugen.com/">Barefoot Rob</a></h1>
            <h2 class="brand-tagline"> keep expanding </h2>
        </hgroup>

        <nav class="nav">
            <ul class="nav-list">
                
                
                
                
                <li class="nav-item">
                    <a class="pure-button" href='/'>
                        <i class="fa"></i> home
                    </a>
                </li>
                <li class="nav-item">
                    <a class="pure-button" href='https://new.robnugen.com/journal'>
                        <i class="fa"></i> journal
                    </a>
                </li>
                <li class="nav-item">
                    <a class="pure-button" href='https://new.robnugen.com/blog'>
                        <i class="fa"></i> blog
                    </a>
                </li>
                
            </ul>
        </nav>
    </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                <h1 class="content-subhead">05 Jan 2016, 23:51</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://new.robnugen.com/journal/2016/01/05/learning-a-lot-about-aws/" class="post-title">Learning a lot about AWS</a>

                        <p class="post-meta">
                            
                                By <strong class="post-author">Rob Nugen</strong>
                            
                            
                        </p>
                    </header>
                    
                    <div class="post-description">
                        

<h2 id="23-51-tuesday-05-january-2016-jst">23:51 Tuesday 05 January 2016 JST</h2>

<p>I spoke on the phone for 1.5 hours to a guy at AWS support.  He was
patient, understanding, helpful, and many other things that I
appreciated.  He summarized the convo for me, pasted below with some
parts redacted:</p>

<pre><code>Hi,

Thanks for contacting AWS Premium Support. It was a pleasure to speak
with you today in relation to the errors your clients encountered when
accessing your website CB.

I understand in the call that you have set up a Cloudfront
distribution point to serve the requests when users are requesting
images, and it is using ELB (redazzle) as its origin. Meanwhile, your
clients are uploading images to fileswarm.net which is pointing to
your ELB, and in turn images are stored on your backend instances. You
mentioned that in the past 3 days, between 5:00pm and 9:00pm GMT+9,
your clients were seeing some HTTP errors when accessing your website,
but you haven't capture the exact errors they were seeing.

You mentioned that the issues also appeared when uploading the images,
then I started troubleshooting on ELB because this traffic didn't go
through Cloudfront. I notice a few ELB HTTP 5XX errors, and some
spikes on the Max latency which almost reached to 60 seconds, which is
the default timeout value defined on the ELB.

You've enabled the ELB access log so we can have the exact ELB HTTP
5XX errors next time similar issue happens again. From the ELB access
log, you can also see the source IP, requested URL, HTTP response
code, etc. You also have enabled the parameter in Apache configuration
on the backends to record the time used to process the requests. As we
can see in the screenshare, with these information in hand, you can
cross check them to see why some requests are taking longer to be
processed, or not be able to be processed.

ELB HTTP 5XX errors
(link)

Max latency
(link)

Healthyhostcount
(link)

What I missed in the call is that you could also enable Access logs on
CloudFront, which will record the data of customers' requests as well
as the responses, and of course, any errors will be shown there as
well.

So next time when the issues happens, you can try to access the
image/upload the image to your website, and since they are traversing
through different paths, you will be able identify where the issue
resides, and use the logs above mentioned to further troubleshooting
the issue.

Lastly, below are the links we used to enable the %T parameter in
Apache, as well as how you could interpret the information recorded in
ELB access log.

Apache Logs: How Long Does It Take to Serve a Request?
https://www.ducea.com/2008/02/06/apache-logs-how-long-does-it-take-to-serve-a-request/

Monitor Your Load Balancer Using Elastic Load Balancing Access Logs
https://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/access-log-collection.html

I hope you will find above information helpful, if you need any
further assistance, please feel free to contact us again anytime, we
will be delighted to help you further.

Best regards,
</code></pre>

<p>Afterwards, I watched 2 or so hours of instruction on udemy about AWS.
It seems like a great course, and well worth the current sales price!</p>

<p><a href="https://www.udemy.com/aws-certified-solutions-architect-associate/">https://www.udemy.com/aws-certified-solutions-architect-associate/</a></p>

<p>Thanks to <a href="https://acloud.guru">https://acloud.guru</a> for the course (and several others).</p>

                    </div>
                    
                </section>
            </div>
            <div class="pager">
                  <a href="https://new.robnugen.com/journal/2016/01/06/bah/" rel="prev" style="float: left!important">❮ bah</a>
                  <a href="https://new.robnugen.com/journal/2016/01/05/automated-testing-is-fun/" rel="next" style="float: right!important"> Automated testing is fun! ❯</a>
            </div>
            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="https://gohugo.io/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src='https://new.robnugen.com/js/all.min.js'></script>

        </div>
    </div>
</div>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
